@using DailyLoan.Library.Status

<script src="~/lib/js/fileinput.js" type="text/javascript"></script>
<script src="~/lib/js/piexif.js" type="text/javascript"></script>
<script src="~/lib/js/sortable.js" type="text/javascript"></script>
<script src="~/lib/js/fas/theme.js" type="text/javascript"></script>
<script src="~/lib/js/th.js" type="text/javascript"></script>

<div class="card-body bg-light p-3 rounded ">
    <div class="input-group mb-3 input-group-sm">
        <input type="text" id="searchfname" name="Firstname" class="form-control" placeholder="ชื่อ">
        <input type="text" id="searchlname" name="Lastname" class="form-control" placeholder="นามสกุล">
        <input type="text" id="searchaddress" name="Address" class="form-control" placeholder="สถานที่">
        <button type="button" onclick="search();" class="btn btn-info btn-sm">
            <i class="fa fa-search"></i>
            ค้นหา
        </button>
        @if (ViewBag.UserAccess != StatusUserAccess.UserAccess_Audit.ToString())
        {
            <button type="button" class="btn btn-success btn-sm" data-bs-toggle="modal" data-bs-target="#addcustomer">
                <i class="fa fa-plus-circle"></i>
                เพิ่มลูกค้า
            </button>

        }
        <!-- The Modal addcustomer -->
        <div class="modal" id="addcustomer">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <!-- Modal Header -->
                    <div class="modal-header" style="background-color:#ff9800;color:#000;">
                        <h4 class="modal-title">เพิ่มข้อมูลลูกค้า</h4>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <!-- Modal body -->
                    <div class="modal-body">
                        <form>
                            <div class="form-row">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-md-6 pb-3">
                                            <label for="addfirstname">ชื่อ</label>
                                            <input type="text" class="form-control form-control-sm" id="addfirstname" placeholder="ชื่อ" required>
                                        </div>
                                        <div class="col-md-6 pb-3">
                                            <label for="addlastname">นามสกุล</label>
                                            <input type="text" class="form-control form-control-sm" id="addlastname" placeholder="นามสกุล" required>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-md-6 pb-3">
                                            <label for="addnickname">ชื่อเล่น</label>
                                            <input type="text" class="form-control form-control-sm" id="addnickname" placeholder="ชื่อเล่น">
                                        </div>
                                        <div class="col-md-6 pb-3">
                                            <label for="addidcard">เลขบัตรประจำตัวประชาชน</label>
                                            <input type="text" class="form-control form-control-sm" id="addidcard" placeholder="เลขบัตรประจำตัวประชาชน" required>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-md-6 pb-3">
                                            <label for="addphone1">เบอร์โทร 1</label>
                                            <input type="text" class="form-control form-control-sm" id="addphone1" placeholder="เบอร์โทร 1">
                                        </div>
                                        <div class="col-md-6 pb-3">
                                            <label for="addphone2">เบอร์โทร 2</label>
                                            <input type="text" class="form-control form-control-sm" id="addphone2" placeholder="เบอร์โทร 2">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            @if (ViewBag.UserAccess == StatusUserAccess.UserAccess_Superadmin.ToString())
                            {
                                <div class="form-row">
                                    <div class="container-fluid">
                                        <div class="row">
                                            <div class="col-md-6 pb-3">
                                                <label for="addhouse" class="form-label">บ้าน</label>
                                                <select class="form-select form-select-sm" id="addhouse" name="addhouse">
                                                    @foreach (var item in ViewBag.House)
                                                    {
                                                        <option value="@item.Id">@item.HouseName</option>
                                                    }
                                                </select>
                                            </div>
                                            <div class="col-md-6 pb-3">
                                                <label for="addcustomerline" class="form-label">สาย</label>
                                                <select class="form-select form-select-sm" id="addcustomerline" name="addcustomerline">
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                            else if (ViewBag.UserAccess == StatusUserAccess.UserAccess_Admin.ToString())
                            {
                                <div class="form-row">
                                    <div class="container-fluid">
                                        <div class="row">
                                            <div class="col-md-6 pb-3">
                                                <label for="addcustomerline" class="form-label">สาย</label>
                                                <select class="form-select form-select-sm" id="addcustomerline" name="addcustomerline">
                                                    @if (ViewBag.CustomerLine.Count > 0)
                                                    {
                                                        @foreach (var item in ViewBag.CustomerLine)
                                                        {
                                                            <option value="@item.Id">@item.CustomerLineName</option>
                                                        }
                                                    }
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                            else
                            {
                                <input type="hidden" id="addcustomerline" name="addcustomerline" />
                            }
                            <div class="form-row">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-md-6 pb-3">
                                            <label for="addaddress">สถานที่</label>
                                            <input type="text" class="form-control form-control-sm" id="addaddress" placeholder="สถานที่">
                                        </div>
                                        <div class="col-md-6 pb-3">
                                            <label for="addshortaddress">สถานที่ย่อ</label>
                                            <input type="text" class="form-control form-control-sm" id="addshortaddress" placeholder="สถานที่">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-md-6 pb-3">
                                            <input type="radio" id="addstatus1" checked="checked" disabled name="addstatus" value="1">
                                            <label for="addstatus1">ดี</label>
                                            <input type="radio" id="addstatus2" name="addstatus" disabled value="2">
                                            <label for="addstatus2">แย่</label>
                                            <input type="radio" id="addstatus3" name="addstatus" disabled value="3">
                                            <label for="addstatus3">เสีย</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col pb-3">
                                            <label for="inputEmail4">รูปบัตรประชาชน</label>
                                            <form enctype="multipart/form-data">
                                                <div class="file-loading">
                                                    <input id="uploadfile1" name="uploadfile1" class="file" type="file" multiple>
                                                </div>
                                            </form>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <!-- Modal footer -->
                    <div class="modal-footer">
                        <button type="button" class="btn btn-success" onclick="saveadd();" data-bs-dismiss="modal">บันทึก</button>
                        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">ปิด</button>
                    </div>

                </div>
            </div>
        </div>
        <!-- The Modal viewcustomer -->
        <div class="modal" id="viewcustomer">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <!-- Modal Header -->
                    <div class="modal-header" style="background-color:#ff9800;color:#000;">
                        <h4 class="modal-title">ข้อมูลลูกค้า</h4>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <!-- Modal body -->
                    <div class="modal-body">
                        <form>
                            <div class="form-row">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-md-6 pb-3">
                                            <label for="viewfirstname">ชื่อ</label>
                                            <input type="text" class="form-control form-control-sm" id="viewfirstname" placeholder="ชื่อ" readonly>
                                        </div>
                                        <div class="col-md-6 pb-3">
                                            <label for="viewlastname">นามสกุล</label>
                                            <input type="text" class="form-control form-control-sm" id="viewlastname" placeholder="นามสกุล" readonly>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-md-6 pb-3">
                                            <label for="viewnickname">ชื่อเล่น</label>
                                            <input type="text" class="form-control form-control-sm" id="viewnickname" placeholder="ชื่อเล่น" readonly>
                                        </div>
                                        <div class="col-md-6 pb-3">
                                            <label for="viewidcard">เลขบัตรประจำตัวประชาชน</label>
                                            <input type="text" class="form-control form-control-sm" id="viewidcard" placeholder="เลขบัตรประจำตัวประชาชน" readonly>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-md-6 pb-3">
                                            <label for="viewphone1">เบอร์โทร 1</label>
                                            <input type="text" class="form-control form-control-sm" id="viewphone1" placeholder="เบอร์โทร 1" readonly>
                                        </div>
                                        <div class="col-md-6 pb-3">
                                            <label for="viewphone2">เบอร์โทร 2</label>
                                            <input type="text" class="form-control form-control-sm" id="viewphone2" placeholder="เบอร์โทร 2" readonly>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            @if (ViewBag.UserAccess == StatusUserAccess.UserAccess_Superadmin.ToString())
                            {
                                <div class="form-row">
                                    <div class="container-fluid">
                                        <div class="row">
                                            <div class="col-md-6 pb-3">
                                                <label for="viewhouse">บ้าน</label>
                                                <input type="text" class="form-control form-control-sm" id="viewhouse" placeholder="" readonly>
                                            </div>
                                            <div class="col-md-6 pb-3">
                                                <label for="viewcustomerline">สาย</label>
                                                <input type="text" class="form-control form-control-sm" id="viewcustomerline" placeholder="" readonly>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                            else if (ViewBag.UserAccess == StatusUserAccess.UserAccess_Admin.ToString())
                            {
                                <div class="form-row">
                                    <div class="container-fluid">
                                        <div class="row">
                                            <div class="col-md-6 pb-3">
                                                <label for="viewcustomerline">สาย</label>
                                                <input type="text" class="form-control form-control-sm" id="viewcustomerline" placeholder="" readonly>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                            <div class="form-row">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-md-6 pb-3">
                                            <label for="viewaddress">สถานที่</label>
                                            <input type="text" class="form-control form-control-sm" id="viewaddress" placeholder="สถานที่" readonly>
                                        </div>
                                        <div class="col-md-6 pb-3">
                                            <label for="viewshortaddress">สถานที่ย่อ</label>
                                            <input type="text" class="form-control form-control-sm" id="viewshortaddress" placeholder="สถานที่" readonly>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-md-6 pb-3">
                                            <input type="radio" id="viewstatus1" name="viewstatus" value="1" disabled>
                                            <label for="viewstatus1">ดี</label>
                                            <input type="radio" id="viewstatus2" name="viewstatus" value="2" disabled>
                                            <label for="viewstatus2">แย่</label>
                                            <input type="radio" id="viewstatus3" name="viewstatus" value="3" disabled>
                                            <label for="viewstatus3">เสีย</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div id="imgview" class="col pb-3">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <!-- Modal footer -->
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">ปิด</button>
                    </div>

                </div>
            </div>
        </div>
        <!-- The Modal editcustomer -->
        <div class="modal" id="editcustomer">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <!-- Modal Header -->
                    <div class="modal-header" style="background-color:#ff9800;color:#000;">
                        <h4 class="modal-title">แก้ไขข้อมูลลูกค้า</h4>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <!-- Modal body -->
                    <div class="modal-body">
                        <form>
                            <div class="form-row">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-md-6 pb-3">
                                            <label for="firstname">ชื่อ</label>
                                            <input type="text" class="form-control form-control-sm" id="firstname" placeholder="ชื่อ">
                                        </div>
                                        <div class="col-md-6 pb-3">
                                            <label for="lastname">นามสกุล</label>
                                            <input type="text" class="form-control form-control-sm" id="lastname" placeholder="นามสกุล">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-md-6 pb-3">
                                            <label for="nickname">ชื่อเล่น</label>
                                            <input type="text" class="form-control form-control-sm" id="nickname" placeholder="ชื่อเล่น">
                                        </div>
                                        <div class="col-md-6 pb-3">
                                            <label for="idcard">เลขบัตรประจำตัวประชาชน</label>
                                            <input type="text" class="form-control form-control-sm" id="idcard" placeholder="เลขบัตรประจำตัวประชาชน">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-md-6 pb-3">
                                            <label for="phone1">เบอร์โทร 1</label>
                                            <input type="text" class="form-control form-control-sm" id="phone1" placeholder="เบอร์โทร 1">
                                        </div>
                                        <div class="col-md-6 pb-3">
                                            <label for="phone2">เบอร์โทร 2</label>
                                            <input type="text" class="form-control form-control-sm" id="phone2" placeholder="เบอร์โทร 2">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            @if (ViewBag.UserAccess == StatusUserAccess.UserAccess_Superadmin.ToString())
                            {
                                <div class="form-row">
                                    <div class="container-fluid">
                                        <div class="row">
                                            <div class="col-md-6 pb-3">
                                                <label for="house" class="form-label">บ้าน</label>
                                                <select class="form-select form-select-sm" id="house" name="house">
                                                    @foreach (var item in ViewBag.House)
                                                    {
                                                        <option value="@item.Id">@item.HouseName</option>
                                                    }
                                                </select>
                                            </div>
                                            <div class="col-md-6 pb-3">
                                                <label for="customerline" class="form-label">สาย</label>
                                                <select class="form-select form-select-sm" id="customerline" name="customerline">
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                            else if (ViewBag.UserAccess == StatusUserAccess.UserAccess_Admin.ToString())
                            {
                                <div class="form-row">
                                    <div class="container-fluid">
                                        <div class="row">
                                            <div class="col-md-6 pb-3">
                                                <label for="customerline" class="form-label">สาย</label>
                                                <select class="form-select form-select-sm" id="customerline" name="customerline">
                                                    @if (ViewBag.CustomerLine.Count > 0)
                                                    {
                                                        @foreach (var item in ViewBag.CustomerLine)
                                                        {
                                                            <option value="@item.Id">@item.CustomerLineName</option>
                                                        }
                                                    }
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                            else
                            {
                                <input type="hidden" id="customerline" name="customerline" />
                            }
                            <div class="form-row">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-md-6 pb-3">
                                            <label for="address">สถานที่</label>
                                            <input type="text" class="form-control form-control-sm" id="address" placeholder="สถานที่">
                                        </div>
                                        <div class="col-md-6 pb-3">
                                            <label for="shortaddress">สถานที่ย่อ</label>
                                            <input type="text" class="form-control form-control-sm" id="shortaddress" placeholder="สถานที่">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-md-6 pb-3">
                                            <input type="radio" id="status1" name="status" value="1">
                                            <label for="status1">ดี</label>
                                            <input type="radio" id="status2" name="status" value="2">
                                            <label for="status2">แย่</label>
                                            <input type="radio" id="status3" name="status" value="3">
                                            <label for="status3">เสีย</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col pb-3">
                                            <label for="idcardpic">รูปบัตรประชาชน</label>
                                            <form enctype="multipart/form-data">
                                                <div class="file-loading">
                                                    <input id="uploadfile2" name="uploadfile2" class="file" type="file" multiple>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <input type="hidden" id="editid" />
                    <!-- Modal footer -->
                    <div class="modal-footer">
                        <button type="button" class="btn btn-success" onclick="save();" data-bs-dismiss="modal">บันทึก</button>
                        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">ปิด</button>
                    </div>

                </div>
            </div>
        </div>
        <!--end -->
        <div class="modal" id="movecustomer">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <!-- Modal Header -->
                    <div class="modal-header" style="background-color:#ff9800;color:#000;">
                        <h4 class="modal-title">ย้ายสายลูกค้า</h4>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <!-- Modal body -->
                    <div class="modal-body">
                        <form>
                            <div class="form-row">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-md-6 pb-3">
                                            <label for="firstname">ชื่อ</label>
                                            <input type="text" class="form-control form-control-sm" id="movefirstname" placeholder="ชื่อ" readonly>
                                        </div>
                                        <div class="col-md-6 pb-3">
                                            <label for="lastname">นามสกุล</label>
                                            <input type="text" class="form-control form-control-sm" id="movelastname" placeholder="นามสกุล" readonly>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-md-6 pb-3">
                                            <label for="nickname">ชื่อเล่น</label>
                                            <input type="text" class="form-control form-control-sm" id="movenickname" placeholder="ชื่อเล่น" readonly>
                                        </div>
                                        <div class="col-md-6 pb-3">
                                            <label for="idcard">เลขบัตรประจำตัวประชาชน</label>
                                            <input type="text" class="form-control form-control-sm" id="moveidcard" placeholder="เลขบัตรประจำตัวประชาชน" readonly>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-md-6 pb-3">
                                            <label for="phone1">เบอร์โทร 1</label>
                                            <input type="text" class="form-control form-control-sm" id="movephone1" placeholder="เบอร์โทร 1" readonly>
                                        </div>
                                        <div class="col-md-6 pb-3">
                                            <label for="phone2">เบอร์โทร 2</label>
                                            <input type="text" class="form-control form-control-sm" id="movephone2" placeholder="เบอร์โทร 2" readonly>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            @if (ViewBag.UserAccess == StatusUserAccess.UserAccess_Superadmin.ToString())
                            {
                                <div class="form-row">
                                    <div class="container-fluid">
                                        <div class="row">
                                            <div class="col-md-6 pb-3">
                                                <label for="house" class="form-label">บ้าน</label>
                                                <select class="form-select form-select-sm" id="movehouse" name="movehouse">
                                                    @foreach (var item in ViewBag.House)
                                                    {
                                                        <option value="@item.Id">@item.HouseName</option>
                                                    }
                                                </select>
                                            </div>
                                            <div class="col-md-6 pb-3">
                                                <label for="customerline" class="form-label">สาย</label>
                                                <select class="form-select form-select-sm" id="movecustomerline" name="movecustomerline">
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                            else if (ViewBag.UserAccess == StatusUserAccess.UserAccess_Admin.ToString())
                            {
                                <div class="form-row">
                                    <div class="container-fluid">
                                        <div class="row">
                                            <div class="col-md-6 pb-3">
                                                <label for="customerline" class="form-label">สาย</label>
                                                <select class="form-select form-select-sm" id="movecustomerline" name="movecustomerline">
                                                    @if (ViewBag.CustomerLine.Count > 0)
                                                    {
                                                        @foreach (var item in ViewBag.CustomerLine)
                                                        {
                                                            <option value="@item.Id">@item.CustomerLineName</option>
                                                        }
                                                    }
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                            <div class="form-row">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-md-6 pb-3">
                                            <input type="radio" id="movestatus1" name="movestatus" value="1" disabled>
                                            <label for="movestatus1">ดี</label>
                                            <input type="radio" id="movestatus2" name="movestatus" value="2" disabled>
                                            <label for="movestatus2">แย่</label>
                                            <input type="radio" id="movestatus3" name="movestatus" value="3" disabled>
                                            <label for="movestatus3">เสีย</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div id="imgmove" class="col pb-3">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <input type="hidden" id="moveid" />
                    <!-- Modal footer -->
                    <div class="modal-footer">
                        <button type="button" class="btn btn-success" onclick="savemove();" data-bs-dismiss="modal">บันทึก</button>
                        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">ปิด</button>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>
<table id="table" class="table table-hover" style="text-align: center; vertical-align: middle;">
    <thead>
        <tr>
            <th style="display:none;" scope="col">#</th>
            <th scope="col">#</th>
            <th scope="col">ชื่อ</th>
            <th scope="col">นามสกุล</th>
            <th scope="col">สถานที่</th>
            <th scope="col">สถานะ</th>
            @if (ViewBag.UserAccess == StatusUserAccess.UserAccess_Superadmin.ToString())
            {
                <th scope="col">บ้าน</th>
            }
            @if (int.Parse(ViewBag.UserAccess) <= StatusUserAccess.UserAccess_Admin)
            {
                <th scope="col">สาย</th>
            }
            <th scope="col"></th>
        </tr>
    </thead>
    <tbody>
        @if (ViewBag.PageData.Count > 0)
        {
            var i = 1;
            foreach (var items in ViewBag.PageData)
            {
        <tr class='clickable-row'>
            <th style="display:none;" scope="row">@items.Id</th>
            <th>@i</th>
            <td>@items.Firstname</td>
            <td>@items.Lastname</td>
            <td>@items.Address</td>
            <td>@items.StatusText</td>
            @if (ViewBag.UserAccess == StatusUserAccess.UserAccess_Superadmin.ToString())
            {
                <td>@items.HouseText</td>
            }
            @if (int.Parse(ViewBag.UserAccess) <= StatusUserAccess.UserAccess_Admin)
            {
                <td>@items.CustomerLineText</td>
            }
        <td>
            <button type="button" class="btn btn-primary btn-sm btn-view" data-bs-toggle="modal" data-bs-target="#viewcustomer">
                <i class="fa fa-eye"></i>
                ดู
            </button>
            @if (int.Parse(ViewBag.UserAccess) <= StatusUserAccess.UserAccess_Admin)
            {
                <button type="button" class="btn btn-warning btn-sm btn-edit" data-bs-toggle="modal" data-bs-target="#editcustomer">
                    <i class="fa fa-pen-square"></i>
                    แก้ไข
                </button>
                <button type="button" class="btn btn-warning btn-sm btn-move" data-bs-toggle="modal" data-bs-target="#movecustomer">
                    <i class="fa fa-pen-square"></i>
                    ย้ายสาย
                </button>
                
            }
            @if (ViewBag.UserAccess == StatusUserAccess.UserAccess_Superadmin.ToString())
                    {
        <button type="button" class="btn btn-danger btn-sm btn-delete" data-bs-toggle="modal" data-bs-target="#delcustomer">
            <i class="fa fa-trash-alt"></i>
            ลบ
        </button>
                    }
            </td>
        </tr>
        i++;
            }
        }
    </tbody>
</table>
<!-- The Modal deletecustomer -->
<div class="modal" id="delcustomer">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <!-- Modal Header -->
            <div class="modal-header" style="background-color:red;color:#fff;">
                <h4 class="modal-title">ลบข้อมูล</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <!-- Modal body -->
            <div class="modal-body">
                <form>
                    <h5>คุณต้องการลบข้อมูลลูกค้า <span id="deletename"></span> ใช่หรือไม่?</h5>
                </form>
            </div>
            <!-- Modal footer -->
            <div class="modal-footer">
                <button type="button" id="delete" class="btn btn-danger" data-bs-dismiss="modal">ลบ</button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ปิด</button>
            </div>
            <input type="hidden" id="deleteid" />
        </div>
    </div>
</div>
<!--end -->

<input type="hidden" id="uploaded0" />
<input type="hidden" id="uploaded1" />
<input type="hidden" id="uploaded2" />
<input type="hidden" id="uploaded3" />
<input type="hidden" id="uploaded4" />
<input type="hidden" id="uploaded5" />
<input type="hidden" id="uploaded6" />
<input type="hidden" id="uploaded7" />
<input type="hidden" id="uploaded8" />
<input type="hidden" id="uploaded9" />
<form id="searchform" style="display:none;" method="POST" action="/SearchCustomerPage">
    <input type="text" id="ffirstname" name="Firstname">
    <input type="text" id="flastname" name="Lastname">
    <input type="text" id="faddress" name="Address">
</form>
<script type="text/javascript">
    var root = '@Url.Content("~/")';
    var useraccess = '@ViewBag.UserAccess';
    var superadmin = '@StatusUserAccess.UserAccess_Superadmin';
    var admin = '@StatusUserAccess.UserAccess_Admin';
    root = (root == '/' ? "" : root);
    function search() {
        $("#ffirstname").val($("#searchfname").val());
        $("#flastname").val($("#searchlname").val());
        $("#faddress").val($("#searchaddress").val());
        document.getElementById("searchform").submit();
    }
    function save() {
        if ($("#uploadfile2")[0].files.length > 0) {
            $("#uploadfile2").fileinput("upload");
        } else {
            let req = new XMLHttpRequest();
            let formData = new FormData();
            formData.append("isNew", false);
            formData.append("HouseId", $("#house").val());
            formData.append("Status", $('input[name="status"]:checked').val() != undefined ? $('input[name="status"]:checked').val() : '');
            formData.append("Id", $("#editid").val());
            formData.append("CustomerLineId", $("#customerline").val());
            formData.append("Firstname", $("#firstname").val());
            formData.append("Lastname", $("#lastname").val());
            formData.append("Nickname", $("#nickname").val());
            formData.append("Phone1", $("#phone1").val());
            formData.append("Phone2", $("#phone2").val());
            formData.append("Idcard", $("#idcard").val());
            formData.append("Address", $("#address").val());
            formData.append("ShortAddress", $("#shortaddress").val());
            req.open("POST", '/EditCustomer');
            req.send(formData);
            req.onload = function () {
                if (req.readyState != 4 || req.status != 200) {
                    alert(req.responseText);
                //$("#msg").text(req.responseText);
                } else {
                    alert(req.responseText);
                    location.reload();
                }
            }
        }
    }
    function savemove() {
        let req = new XMLHttpRequest();
        let formData = new FormData();
        formData.append("Id", $("#moveid").val());
        formData.append("CustomerLineId", $("#movecustomerline").val());
        req.open("POST", '/MoveCustomer');
        req.send(formData);
        req.onload = function () {
            if (req.readyState != 4 || req.status != 200) {
                alert(req.responseText);
                //$("#msg").text(req.responseText);
            } else {
                alert(req.responseText);
                location.reload();
            }
        }
    }
    function saveadd() {
        var allfill = false;
        $('input[required]').each(function () {
            allfill = this.value != '';
            console.log(this.value);
        });
        if (allfill) {
            if ($("#uploadfile1")[0].files.length > 0) {
                $("#uploadfile1").fileinput("upload");
            } else {
                    let req = new XMLHttpRequest();
                    let formData = new FormData();
                    formData.append("isNew", true);
                    formData.append("HouseId", 0);
                    formData.append("Status", $('input[name="addstatus"]:checked').val() != undefined ? $('input[name="addstatus"]:checked').val() : '');
                    formData.append("Id", 0);
                    formData.append("CustomerLineId", $("#addcustomerline").val());
                    formData.append("Firstname", $("#addfirstname").val());
                    formData.append("Lastname", $("#addlastname").val());
                    formData.append("Nickname", $("#addnickname").val());
                    formData.append("Phone1", $("#addphone1").val());
                    formData.append("Phone2", $("#addphone2").val());
                    formData.append("Idcard", $("#addidcard").val());
                    formData.append("Address", $("#addaddress").val());
                    formData.append("ShortAddress", $("#addshortaddress").val());
                    req.open("POST", '/EditCustomer');
                    req.send(formData);
                    req.onload = function () {
                        if (req.readyState != 4 || req.status != 200) {
                            alert(req.responseText);
                        } else {
                            alert(req.responseText);
                            location.reload();
                        }
                    }
                }
        } else {
            alert('กรุณาใส่ข้อมูลให้ครบ');
        }
    }
    $(document).ready(function () {
        /**/
        $('#table').DataTable({
            "ordering": false,
            "dom": 't<"bottom"p>',
            "info": false,
            "pageLength": 15,
            "bLengthChange": false,
            "language": {
                "paginate": {
                    "previous": "ก่อนหน้า",
                    "next": "ถัดไป",
                }
            },
            "initComplete": function () {

            }
        });
        /**/
        if (useraccess == superadmin) {
            $('#house').on('change', function () {
                $('#customerline').empty();
                $.ajax({
                    type: "GET",
                    url: root + "/GetCustomerLineAll/" + $("#house").val(),
                    contentType: "application/json; charset=utf-8;",
                    dataType: "json",
                    success: function (data) {
                        if (data != undefined) {
                            for (var it of data) {
                                $('#customerline').append('<option value="' + it['id'] + '">' + it['customerLineName'] + '</option>');
                            }
                        }
                    },
                    error: function (e) { console.log(e) }
                });
            });
            if ($('#house').val() != 0 && $('#house').val() != 1) {
                $('#customerline').empty();
                $.ajax({
                    type: "GET",
                    url: root + "/GetCustomerLineAll/" + $("#house").val(),
                    contentType: "application/json; charset=utf-8;",
                    dataType: "json",
                    success: function (data1) {
                        if (data1 != undefined) {
                            for (var it of data1) {
                                $('#customerline').append('<option value="' + it['id'] + '">' + it['customerLineName'] + '</option>');
                            }
                        }
                    },
                    error: function (e) { console.log(e) }
                });
            }
            $('#addhouse').on('change', function () {
                $('#addcustomerline').empty();
                $.ajax({
                    type: "GET",
                    url: root + "/GetCustomerLineAll/" + $("#addhouse").val(),
                    contentType: "application/json; charset=utf-8;",
                    dataType: "json",
                    success: function (data) {
                        if (data != undefined) {
                            for (var it of data) {
                                $('#addcustomerline').append('<option value="' + it['id'] + '">' + it['customerLineName'] + '</option>');
                            }
                        }
                    },
                    error: function (e) { console.log(e) }
                });
            });
            if ($('#addhouse').val() != 0 && $('#addhouse').val() != 1) {
                $('#addcustomerline').empty();
                $.ajax({
                    type: "GET",
                    url: root + "/GetCustomerLineAll/" + $("#addhouse").val(),
                    contentType: "application/json; charset=utf-8;",
                    dataType: "json",
                    success: function (data1) {
                        if (data1 != undefined) {
                            for (var it of data1) {
                                $('#addcustomerline').append('<option value="' + it['id'] + '">' + it['customerLineName'] + '</option>');
                            }
                        }
                    },
                    error: function (e) { console.log(e) }
                });
            }
            $('#movehouse').on('change', function () {
                $('#movecustomerline').empty();
                $.ajax({
                    type: "GET",
                    url: root + "/GetCustomerLineAll/" + $("#movehouse").val(),
                    contentType: "application/json; charset=utf-8;",
                    dataType: "json",
                    success: function (data) {
                        if (data != undefined) {
                            for (var it of data) {
                                $('#movecustomerline').append('<option value="' + it['id'] + '">' + it['customerLineName'] + '</option>');
                            }
                        }
                    },
                    error: function (e) { console.log(e) }
                });
            });
            if ($('#movehouse').val() != 0 && $('#movehouse').val() != 1) {
                $('#movecustomerline').empty();
                $.ajax({
                    type: "GET",
                    url: root + "/GetCustomerLineAll/" + $("#movehouse").val(),
                    contentType: "application/json; charset=utf-8;",
                    dataType: "json",
                    success: function (data1) {
                        if (data1 != undefined) {
                            for (var it of data1) {
                                $('#movecustomerline').append('<option value="' + it['id'] + '">' + it['customerLineName'] + '</option>');
                            }
                        }
                    },
                    error: function (e) { console.log(e) }
                });
            }
        }
        $('table tbody').on('click', '.btn-move', function () {
            $("#moveid").val($(this).closest('tr').find('th').eq(0).text());
            $.ajax({
                type: "GET",
                url: root + "/GetCustomerDetail/" + $(this).closest('tr').find('th').eq(0).text(),
                contentType: "application/json; charset=utf-8;",
                dataType: "json",
                success: function (data) {
                    if (data != undefined) {
                        $("#movehouse").val(data.houseText);
                        $("#moveidcard").val(data.idcard);
                        $("#movefirstname").val(data.firstname);
                        $("#movelastname").val(data.lastname);
                        $("#movenickname").val(data.nickname);
                        $("#movephone1").val(data.phone1);
                        $("#movephone2").val(data.phone2);
                        $("#moveaddress").val(data.address);
                        if (data.status == 1)
                            $("#movestatus1").prop('checked', true);
                        else if (data.status == 2)
                            $("#movestatus2").prop('checked', true);
                        else if (data.status == 3)
                            $("#movestatus3").prop('checked', true);
                        $("#movecustomerline").val(data.customerLineText);
                        $('<label for="inputEmail4">รูปบัตรประชาชน</label><br />').appendTo($('#imgmove').empty());
                        if (data.images != null) {
                            for (var i in data.images) {
                                $('#imgmove').append('<img src="/upload/' + data.images[i] + '" style="width:100px;margin-left:20px;">');
                            }
                        }
                    }
                },
                error: function (e) { console.log(e) }
            });
        });
        $('table tbody').on('click', '.btn-view', function () {
            $.ajax({
                type: "GET",
                url: root + "/GetCustomerDetail/" + $(this).closest('tr').find('th').eq(0).text(),
                contentType: "application/json; charset=utf-8;",
                dataType: "json",
                success: function (data) {
                    if (data != undefined) {
                        $("#viewhouse").val(data.houseText);
                        $("#viewidcard").val(data.idcard);
                        $("#viewfirstname").val(data.firstname);
                        $("#viewlastname").val(data.lastname);
                        $("#viewnickname").val(data.nickname);
                        $("#viewphone1").val(data.phone1);
                        $("#viewphone2").val(data.phone2);
                        $("#viewaddress").val(data.address);
                        if (data.status == 1)
                            $("#viewstatus1").prop('checked', true);
                        else if (data.status == 2)
                            $("#viewstatus2").prop('checked', true);
                        else if (data.status == 3)
                            $("#viewstatus3").prop('checked', true);
                        $("#viewcustomerline").val(data.customerLineText);
                        $('<label for="inputEmail4">รูปบัตรประชาชน</label><br />').appendTo($('#imgview').empty());
                        if (data.images != null) {
                            for (var i in data.images) {
                                $('#imgview').append('<img src="/upload/' + data.images[i] + '" style="width:100px;margin-left:20px;">');
                            }
                        } 
                    }
                },
                error: function (e) { console.log(e) }
            });
        });
        $('table tbody').on('click', '.btn-edit', function () {
            $("#editid").val($(this).closest('tr').find('th').eq(0).text());
            $.ajax({
                type: "GET",
                url: root + "/GetCustomerDetail/" + $(this).closest('tr').find('th').eq(0).text(),
                contentType: "application/json; charset=utf-8;",
                dataType: "json",
                success: function (data) {
                    if (data != undefined) {
                        $("#idcard").val(data.idcard);
                        $("#firstname").val(data.firstname);
                        $("#lastname").val(data.lastname);
                        $("#nickname").val(data.nickname);
                        $("#phone1").val(data.phone1);
                        $("#phone2").val(data.phone2);
                        $("#address").val(data.address);
                        $("#shortaddress").val(data.shortAddress);
                        if (data.status == 1)
                            $("#status1").prop('checked', true);
                        else if (data.status == 2)
                            $("#status2").prop('checked', true);
                        else if (data.status == 3)
                            $("#status3").prop('checked', true);
                        $("#house").val(data.houseId);
                        $('#customerline').empty();
                        $.ajax({
                            type: "GET",
                            url: root + "/GetCustomerLineAll/" + $("#house").val(),
                            contentType: "application/json; charset=utf-8;",
                            dataType: "json",
                            success: function (data1) {
                                if (data1 != undefined) {
                                    for (var it of data1) {
                                        $('#customerline').append('<option value="' + it['id'] + '">' + it['customerLineName'] + '</option>');
                                    }
                                    $("#customerline").val(data.customerLineId);
                                }
                            },
                            error: function (e) { console.log(e) }
                        });
                    }
                },
                error: function (e) { console.log(e) }
            });
        });
        $('table tbody').on('click', '.btn-delete', function () {
            $("#deleteid").val($(this).closest('tr').find('th').eq(0).text());
            $("#deletename").html($(this).closest('tr').find('td').eq(0).text() + ' '+$(this).closest('tr').find('td').eq(1).text());
        });
        $("#delete").click(function () {
            let req = new XMLHttpRequest();
            req.open("GET", '/DeleteCustomer/' + $("#deleteid").val());
            req.send();
            req.onload = function () {
                if (req.readyState != 4 || req.status != 200) {
                    $("#msg").text(req.responseText)
                } else {
                    alert(req.responseText);
                    location.reload();
                }
            }
        });
    });
    $("#uploadfile1").fileinput({
        language: "th",
        theme: 'fas',
        showCaption: false,
        showPreview: true,
        showUpload: false,
        showRemove: true,
        fileActionSettings: {

            showDownload: false,
            showUpload: false,
            showRemove: true
        },
        uploadAsync: false,
        showCancel: false,
        dropZoneEnabled: true,
        browseOnZoneClick: true,
        minFileCount: 1,
        maxFileCount: 10,
        allowedFileTypes: ['image'],
        allowedFileExtensions: ["jpg", "png", "jpeg"],
        initialPreviewAsData: true,
        overwriteInitial: true,
        uploadUrl: '/UploadFileCustomer',
        deleteUrl: "/delete"
    }).on('fileuploaderror', function (event, data, msg) {
        console.log('File Upload Error', 'ID: ' + data.fileId + ', Thumb ID: ' + data.previewId, msg);
    }).on('filebatchuploadsuccess', function (event, data) {
        var form = data.form, files = data.files, extra = data.extra,
            response = data.response, reader = data.reader;
        if (!response.error) {
            let req = new XMLHttpRequest();
            let formData = new FormData();
            formData.append("isNew", true);
            formData.append("HouseId", 0);
            formData.append("Status", $('input[name="addstatus"]:checked').val() != undefined ? $('input[name="addstatus"]:checked').val() : '');
            formData.append("Id", 0);
            formData.append("CustomerLineId", $("#addcustomerline").val());
            formData.append("Firstname", $("#addfirstname").val());
            formData.append("Lastname", $("#addlastname").val());
            formData.append("Nickname", $("#addnickname").val());
            formData.append("Phone1", $("#addphone1").val());
            formData.append("Phone2", $("#addphone2").val());
            formData.append("Idcard", $("#addidcard").val());
            formData.append("Address", $("#addaddress").val());
            formData.append("ShortAddress", $("#addshortaddress").val());
            for (var i in response.filename) {
                $('#uploaded' + i).val(response.filename[i]);
                formData.append("uploaded" + i, response.filename[i]);
            }
            req.open("POST", '/EditCustomer');
            req.send(formData);
            req.onload = function () {
                if (req.readyState != 4 || req.status != 200) {
                    alert(req.responseText);
                //$("#msg").text(req.responseText);
                } else {
                    alert(req.responseText);
                    location.reload();
                }
            }
        }
    });
    $("#uploadfile2").fileinput({
        language: "th",
        theme: 'fas',
        showCaption: false,
        showPreview: true,
        showUpload: false,
        showRemove: true,
        fileActionSettings: {

            showDownload: false,
            showUpload: false,
            showRemove: true
        },
        showCancel: false,
        uploadAsync: false,
        dropZoneEnabled: true,
        browseOnZoneClick: true,
        minFileCount: 1,
        maxFileCount: 10,
        allowedFileTypes: ['image'],
        allowedFileExtensions: ["jpg", "png", "jpeg"],
        initialPreviewAsData: true,
        overwriteInitial: true,
        uploadUrl: '/UploadFileCustomer',
        deleteUrl: "/delete"
    }).on('fileuploaderror', function (event, data, msg) {
        console.log('File Upload Error', 'ID: ' + data.fileId + ', Thumb ID: ' + data.previewId, msg);
    }).on('filebatchuploadsuccess', function (event, data) {
        var form = data.form, files = data.files, extra = data.extra,
            response = data.response, reader = data.reader;
        if (!response.error) {
            let req = new XMLHttpRequest();
            let formData = new FormData();
            formData.append("isNew", false);
            formData.append("HouseId", $("#house").val());
            formData.append("Status", $('input[name="status"]:checked').val() != undefined ? $('input[name="status"]:checked').val() : '');
            formData.append("Id", $("#editid").val());
            formData.append("CustomerLineId", $("#customerline").val());
            formData.append("Firstname", $("#firstname").val());
            formData.append("Lastname", $("#lastname").val());
            formData.append("Nickname", $("#nickname").val());
            formData.append("Phone1", $("#phone1").val());
            formData.append("Phone2", $("#phone2").val());
            formData.append("Idcard", $("#idcard").val());
            formData.append("Address", $("#address").val());
            formData.append("ShortAddress", $("#shortaddress").val());
            for (var i in response.filename) {
                $('#uploaded' + i).val(response.filename[i]);
                formData.append("uploaded" + i, response.filename[i]);
            }
            req.open("POST", '/EditCustomer');
            req.send(formData);
            req.onload = function () {
                if (req.readyState != 4 || req.status != 200) {
                    alert(req.responseText);
                //$("#msg").text(req.responseText);
                } else {
                    alert(req.responseText);
                    location.reload();
                }
            }
        }
    });
</script>